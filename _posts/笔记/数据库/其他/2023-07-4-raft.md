---
title: raft
date: 2023-07-4
categories: [笔记, 数据库, DB其他]
tags: [数据库]
---

# raft

## raft

Raft协议是一种一致性分布式协议，用于解决分布式系统中的一致性问题。它是一种强一致性的协议，保证了在网络分区、节点故障等情况下数据的一致性和可靠性。

Raft协议的核心思想是将分布式一致性问题划分为Leader选举、日志复制和安全性三个子问题。

Leader选举：Raft协议通过一个称为Term的概念来进行Leader选举。每个节点都有一个递增的Term值，其中Term值最大的节点成为Leader，负责处理客户端请求。在过程中，节点通过心跳机制来维持Leader的连续性。

日志复制：Raft协议使用日志来记录系统状态的变化。Leader接收到客户端请求后将其转化为一个日志条目，并复制给其他节点进行同步。只有当绝大多数节点都写入并确认了同一条日志条目后，Leader才会将其应用到自己的状态机中。

安全性：在Raft协议中，要确保只有合法的Leader能够提交日志。通过使用选举超时机制和持久化状态来实现，当节点在一定时间内未收到Leader的心跳时，会发起新一轮的选举。同时，重要的状态信息如Term、选举ID等会被持久化到磁盘上，以确保在节点重启后能够恢复到正确的状态。

相对于其他一致性协议，如Paxos，Raft协议的可理解性更强，易于实现和调试，并且具有更好的可扩展性。


### 对比Paxos
一致性的选型已经很长时间没有新的成员加入了。目前来看基本可以归为两家：一种是基于 Leader 的非对等部署的单点写一致性，一种是对等部署的多写一致性。当我们选用服务注册中心的时候，并没有一种协议能够

Paxos和Raft都是用于分布式系统中实现一致性的算法。它们都是基于投票的算法，并在容错和高可用性方面具有一定的优势。

然而，Paxos和Raft在某些方面有所不同。下面是它们的异同对比：

相同点：

* 都是为了实现分布式系统中的一致性而设计的；
* 都采用了投票的方式来达成一致；
* 都采用了领导者选举的方式来避免脑裂问题；
* 都具有容错性和高可用性。

不同点：

* 在Paxos中，节点可以是提议者、学习者或者既是提议者又是学习者；而在Raft中，节点只能是跟随者、候选人或者领导者；
* Raft中的领导者选举算法更加简单，能够更快地选举出领导者；而Paxos中的领导者选举算法相对复杂，可能需要多轮投票才能选出领导者；
* Raft更加注重可读性和易于理解，更容易被开发者理解和实现；Paxos则更加复杂，需要更深入的理解才能正确实现；
* 在Paxos中，如果系统中有节点故障，需要进行故障检测和重新配置，比较繁琐；而在Raft中，如果领导者出现故障，其他节点会快速进行领导者选举，更加容易恢复正常运行。

> 总体而言，Raft更加容易理解和实现，对于初学者来说更容易上手。但是在一些高级场景下，Paxos可能更加适合，例如需要在弱网络条件下保证一致性等。


### 更多
* https://raft.github.io/
* http://thesecretlivesofdata.com/raft/
