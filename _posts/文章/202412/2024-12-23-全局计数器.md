---
title: å…¨å±€è®¡æ•°å™¨
date: 2024-12-23
categories: [æ–‡ç« , '202412']
tags: [goç»„ä»¶]
---

# ç®€ä»‹

ğŸ”—[GitHub](https://github.com/graymonster0927/component/tree/main/safe_counter)

# SafeCounter å…¨å±€è®¡æ•°å™¨

`safecounter` åŒ…æä¾›äº†ä¸€ä¸ªå®‰å…¨çš„è®¡æ•°å™¨å®ç°ï¼Œå¯ç”¨äºåœ¨å¹¶å‘ç¯å¢ƒä¸­å¯¹é”®å€¼è¿›è¡Œè®¡æ•°æ“ä½œã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- åç¨‹å®‰å…¨ï¼šä¿è¯åœ¨å¹¶å‘ç¯å¢ƒä¸­çš„æ•°æ®ä¸€è‡´æ€§
- é”®å€¼è®¡æ•°ï¼šæ”¯æŒå¯¹ `string` ç±»å‹çš„é”®è¿›è¡Œè®¡æ•°
- çµæ´»æ“ä½œï¼šæ”¯æŒå•æ¬¡å¢åŠ ã€æ‰¹é‡å¢åŠ ã€è·å–è®¡æ•°å€¼ã€æ¸…ç†ç­‰æ“ä½œ

## å®‰è£…


```
go get github.com/graymonster0927/component
```

## ä½¿ç”¨ç¤ºä¾‹


```go
package main

import (
    "fmt"
    "github.com/graymonster0927/component/safecounter"
)

func main() {
    // åˆå§‹åŒ–è®¡æ•°å™¨
    counter := safecounter.NewSafeCounter()
    
    // å¢åŠ è®¡æ•°
    counter.Inc("200") // å¢åŠ  HTTP 200 çŠ¶æ€ç çš„è®¡æ•°
    counter.Inc("404") // å¢åŠ  HTTP 404 çŠ¶æ€ç çš„è®¡æ•°
    counter.IncN("500", 3) // å¢åŠ  3 æ¬¡ HTTP 500 çŠ¶æ€ç çš„è®¡æ•°
    
    // è·å–æ‰€æœ‰è®¡æ•°å¹¶æ¸…ç©º
    counts := counter.All(true)
    
    // æ‰“å°ç»“æœ
    for code, count := range counts {
        fmt.Printf("HTTP %d: %d responses\n", code, count)
    }
    
}
```
