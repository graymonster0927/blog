---
title: å¦‚ä½•è¯†åˆ«å¹¶èšåˆrestfulé£æ ¼æ¥å£
date: 2025-03-07
categories: [æ–‡ç« , '202503']
tags: [restful, goç»„ä»¶]
---

## èƒŒæ™¯
è€ƒè™‘åœºæ™¯, å‡ºäºå®‰å…¨è€ƒè™‘, è¦å¯¹å…¬å¸æ‰€æœ‰æœåŠ¡æ¥å£ä¿æŒç›‘æ§, é¿å…æ•æ„Ÿä¿¡æ¯çš„æ³„éœ², å½“è¯†åˆ«å‡ºæŸä¸ªæ¥å£åœ¨è®¿é—®é‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶, å°±å¯ä»¥è¿›è¡Œé¢„è­¦, è®©è¿™ä¸ªé£é™©è¡Œä¸ºè¢«å…³æ³¨åˆ°.  
å½“æŸä¸ªæœåŠ¡å­˜åœ¨restfulé£æ ¼çš„æ¥å£, æ¯”å¦‚/user/get/:name è¿™ç§, é‚£ä¹ˆè®¿é—®é‡å°±åˆ†æ•£åˆ°äº†æ¯ä¸ªæ¥å£, ä»è€Œæ¼æŠ¥, é‚£ä¹ˆå¦‚ä½•è¯†åˆ«å‡ºæ¥restfulé£æ ¼çš„æ¥å£å¹¶ä¸”èšåˆå‘¢?  

## æ–¹æ¡ˆ
1. ä¼ ç»Ÿæ¨¡å‹ 2. æ ‘

## 1.ä¼ ç»Ÿæ¨¡å‹è§£å†³
å¼€å§‹è€ƒè™‘ç”¨ä¼ ç»Ÿæ¨¡å‹çš„æ–¹æ³•è§£å†³, ä¸€éƒ¨åˆ†å› ä¸ºè¿™ä¸ªéœ€æ±‚ä¸ç´§æ€¥, ä¸€éƒ¨åˆ†æ‰¾ä¸ªæœºä¼šæ¥è§¦ä¸‹ä¼ ç»Ÿæ¨¡å‹, å†ä¸€éƒ¨åˆ†LLMæˆæœ¬é«˜...  
æœ€ç»ˆRNNè®­ç»ƒå‡ºæ¥ä¸¤ä¸ªæ¨¡å‹, ä¸€ä¸ªæ˜¯è¯†åˆ«æ¥å£æ˜¯å¦æ˜¯restfulé£æ ¼çš„, ä¸€ä¸ªæ˜¯å¯¹restfulé£æ ¼çš„æ¥å£è¿›è¡Œèšåˆ. å…ˆè¯†åˆ«æ¥å£æ˜¯å¦æ˜¯restfulçš„, å¦‚æœæ˜¯å†èšåˆ, äºŒåˆ†ç±»é—®é¢˜çš„å‚æ•°æ¯”å¤šåˆ†ç±»é—®é¢˜å‚æ•°å°‘, åŒæ—¶restfulæ¥å£çš„æ•°é‡ä¹Ÿå æ¯”å°‘, å› æ­¤åˆ†ä¸¤ä¸ªæ¨¡å‹å…ˆè¯†åˆ«, ç„¶åå†èšåˆ  
è¿‡ç¨‹æ˜¯ tensorflow + gpt2çš„tokenlizer + gpt2çš„embbeding  ç„¶åä¹°é˜¿é‡Œäº‘çš„æŠ¢å å¼å®ä¾‹è·‘...  

#### å‚è€ƒ
> 1. [è‡ªå·±å¼€å§‹è®­ç»ƒä¸€ä¸ªå°æ¨¡å‹](https://graymonster0927.github.io/blog/posts/%E8%87%AA%E5%B7%B1%E5%BC%80%E5%A7%8B%E8%AE%AD%E7%BB%83%E4%B8%80%E4%B8%AA%E5%B0%8F%E6%A8%A1%E5%9E%8B/)

#### ç»“æœ
2 * 2h4c çš„pod, CPUä½¿ç”¨ç‡å¹³å‡åœ¨20%, å†…å­˜30%

> è¿™é‡Œå†…å­˜æœ‰ä¸ªé—®é¢˜, å¯¹ä¸€äº›è®¡ç®—ç¼“å­˜æ¯æ¬¡è¯·æ±‚ç»“æŸéƒ½æ²¡æœ‰æ¸…é™¤, è¿™æ ·å†…å­˜ä¼šä¸€ç›´å¢é•¿ç›´åˆ°oom, ä½†æ˜¯æ¯æ¬¡è¯·æ±‚å®Œéƒ½å»æ¸…ç†ä¼šå¯¼è‡´è®¡ç®—æ¯”è¾ƒæ…¢, æ¥å£å“åº”æ…¢
> å› æ­¤æœ€åå¯¹gunicornå¢åŠ äº†è‡ªåŠ¨é‡å¯å‚æ•°,  "--max-requests", "600", "--max-requests-jitter", "10",  å½“è¯·æ±‚å¤Ÿ600 ä¸ªå, é‡å¯è¿›ç¨‹, è¿™æ ·é¿å…oom, è¯·æ±‚å¤§éƒ¨åˆ†æ¯”è¾ƒå¿«

![img_4.png](/commons/202503/img_4.png)

qps 1, è€—æ—¶500mså·¦å³
![img.png](/commons/202503/img.png)

èšåˆæ•ˆæœ
![img_1.png](/commons/202503/img_1.png)
![img_2.png](/commons/202503/img_2.png)

é—®é¢˜æœ‰ä¸¤ä¸ª
> 1. èƒ½æ”¯æŒçš„qpså¾ˆä½
> 2. èšåˆä¸ç¨³å®š æ¯”å¦‚:  
> /bigdata-zlink/api/task/7979057 åº”è¯¥èšåˆæˆ/bigdata-zlink/api/task/*, æœ€ç»ˆæ˜¯ /bigdata-zlink/api/task/  
> å†æ¯”å¦‚è¿™ä¸¤ä¸ªæ•ˆæœä¸ä¸€è‡´:  
     > /document-application/api/shimo/zyb/v1/users/FZV00015826 => /document-application/api/shimo/zyb/v1/user/  
     > /document-application/api/shimo/zyb/v1/users/M000030 => /document-application/api/shimo/zyb/v1/user//*  

## 2.æ ‘
ç„¶åä¼˜åŒ–, è€ƒè™‘å…¶ä»–æ–¹æ¡ˆ, æ¯”å¦‚æ ‘  
1. å¯¹æ¯ä¸ªæ¥å£éƒ½åŠ å…¥åˆ°ä¸‹é¢çš„æ ‘ç»“æ„, å¯¹ä¸‹é¢ä¾‹å­:  

/get/user/zhang3  
/get/user/li4  
/userinfo/get/profile  

![img_3.png](/commons/202503/img_3.png)

2. ç„¶åè€ƒè™‘ä¸€ä¸ªé˜ˆå€¼, æ¯”å¦‚å½“ä¸€å±‚, çˆ¶èŠ‚ç‚¹+å­èŠ‚ç‚¹éƒ½æ˜¯åŒä¸€ä¸ª, è¿™ä¸€å±‚èŠ‚ç‚¹æ•°è¶…è¿‡é˜ˆå€¼, é‚£è¿™ä¸€å±‚å°±èƒ½èšåˆæˆ* å¯¹ä¸Šé¢ä¾‹å­: 
  å¦‚æœé˜ˆå€¼æ˜¯2, æœ€åä¸€å±‚ä¸¤ä¸ªèŠ‚ç‚¹ zhang3/li4 çš„çˆ¶èŠ‚ç‚¹éƒ½æ˜¯user, å­èŠ‚ç‚¹éƒ½æ˜¯nil(ç©º),  é‚£è¿™ä¸¤ä¸ªèŠ‚ç‚¹èƒ½èšåˆæˆ*, å½“ç„¶æ­£å¸¸é˜ˆå€¼ä¸ä¼šè¿™ä¹ˆä½, 5-10ä¼šæ›´æ­£å¸¸  

3. å¯ä»¥å¯¹æŸäº›ä¸æ˜¯restfulé£æ ¼ä½†åœ¨æŸä¸€å±‚å°±æ˜¯å€¼æ¯”è¾ƒå¤šçš„è¿›è¡ŒåŠ ç™½, æ¯”å¦‚ä¸‹é¢   
/get/user/email  
/get/user/info  
/get/user/telphone 
/get/user/address  
/get/user/profile  
  
  
  

> # å®ç°å¦‚ä¸‹
> ğŸ”—[GitHub ä»“åº“](https://github.com/graymonster0927/component/tree/main/restful_finder)


æœ€ç»ˆæ›¿æ¢äº†æ¨¡å‹çš„æ–¹æ¡ˆ, æ•ˆæœå’Œç»Ÿè®¡å¦‚ä¸‹:

![img_5.png](/commons/202503/img_5.png)
![img_6.png](/commons/202503/img_6.png)
![img_7.png](/commons/202503/img_7.png)

